<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <title>Ejercicio 6 - Tablero 3x3</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
    }
    
    h1 {
      color: white;
      margin-bottom: 20px;
    }
    
    .info {
      background: white;
      padding: 15px 30px;
      border-radius: 8px;
      margin-bottom: 20px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    
    .tablero {
      display: grid;
      grid-template-columns: repeat(3, 100px);
      grid-template-rows: repeat(3, 100px);
      gap: 5px;
      background-color: #333;
      padding: 5px;
      border-radius: 8px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
    }
    
    .casilla {
      background-color: white;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 48px;
      font-weight: bold;
      cursor: pointer;
      user-select: none;
      transition: all 0.3s;
    }
    
    .casilla:hover:not(.ocupada) {
      background-color: #f0f0f0;
      transform: scale(1.05);
    }
    
    .casilla.ocupada {
      cursor: not-allowed;
    }
    
    .x {
      color: #e74c3c;
    }
    
    .o {
      color: #3498db;
    }
    
    button {
      margin-top: 20px;
      padding: 10px 30px;
      font-size: 16px;
      background: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      transition: all 0.3s;
    }
    
    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(0,0,0,0.15);
    }
  </style>
</head>
<body>

  <h1>üéÆ Tres en Raya - Tablero Base</h1>
  
  <div class="info">
    Turno: <strong id="turnoActual">X</strong>
  </div>

  <div class="tablero" id="tablero">
    <!-- Usamos data-index para identificar cada casilla -->
    <div class="casilla" data-index="0"></div>
    <div class="casilla" data-index="1"></div>
    <div class="casilla" data-index="2"></div>
    <div class="casilla" data-index="3"></div>
    <div class="casilla" data-index="4"></div>
    <div class="casilla" data-index="5"></div>
    <div class="casilla" data-index="6"></div>
    <div class="casilla" data-index="7"></div>
    <div class="casilla" data-index="8"></div>
  </div>

  <button id="btnReiniciar">Reiniciar Juego</button>

  <script>
    // ========== SOLUCI√ìN EJERCICIO 6 ==========
    
    // 1) ESTADO DEL JUEGO
    let turno = "X";
    const tablero = document.querySelector('#tablero');
    const turnoActual = document.querySelector('#turnoActual');
    const btnReiniciar = document.querySelector('#btnReiniciar');
    
    // 2) FUNCI√ìN PARA JUGAR EN UNA CASILLA
    // Esta es la MISMA funci√≥n del ejercicio 5
    // La reutilizamos aqu√≠
    function jugar(casilla) {
      // Guard clause: si est√° ocupada, salir
      if (casilla.textContent !== "") {
        console.log("‚ùå Casilla ocupada");
        return;
      }
      
      // Escribir turno
      casilla.textContent = turno;
      casilla.classList.add('ocupada');
      casilla.classList.add(turno.toLowerCase()); // A√±adir clase x u o
      
      // Cambiar turno
      turno = turno === "X" ? "O" : "X";
      turnoActual.textContent = turno;
      
      console.log(`‚úÖ Jugada en casilla ${casilla.dataset.index}. Siguiente: ${turno}`);
    }
    
    // 3) EVENT DELEGATION: UN SOLO LISTENER EN EL TABLERO
    // En lugar de 9 listeners (uno por casilla)
    // ponemos 1 solo listener en el PADRE (el tablero)
    tablero.addEventListener('click', (e) => {
      // e = evento que contiene informaci√≥n sobre el click
      // e.target = el elemento espec√≠fico que fue clickeado
      // e.currentTarget = el elemento que tiene el listener (tablero)
      
      console.log('Click en:', e.target);
      console.log('Listener est√° en:', e.currentTarget);
      
      // Verificar que se hizo clic en una CASILLA
      // (no en el tablero o en los espacios entre casillas)
      if (e.target.classList.contains('casilla')) {
        // Ahora sabemos con certeza que es una casilla
        jugar(e.target);
      } else {
        console.log('‚ö†Ô∏è Click fuera de una casilla');
      }
    });
    
    // 4) FUNCI√ìN PARA REINICIAR
    function reiniciar() {
      const casillas = document.querySelectorAll('.casilla');
      
      casillas.forEach(casilla => {
        casilla.textContent = "";
        casilla.classList.remove('ocupada', 'x', 'o');
      });
      
      turno = "X";
      turnoActual.textContent = turno;
      
      console.log("üîÑ Juego reiniciado");
    }
    
    btnReiniciar.addEventListener('click', reiniciar);
    
    // ========== CONCEPTOS CLAVE: EVENT DELEGATION ==========
    
    // ‚úÖ ¬øQU√â ES EVENT DELEGATION?
    // T√©cnica donde ponemos UN listener en el elemento PADRE
    // en lugar de poner listeners en cada elemento HIJO
    
    // ‚úÖ ¬øC√ìMO FUNCIONA?
    // Cuando haces click en una casilla, el evento "burbujea" hacia arriba:
    // 
    // Casilla (donde hiciste click)
    //    ‚Üì
    // Tablero (donde est√° el listener) ‚Üê Aqu√≠ lo capturamos
    //    ‚Üì
    // Body
    //    ‚Üì
    // HTML
    
    // ‚úÖ e.target vs e.currentTarget
    // e.target ‚Üí El elemento que RECIBI√ì el click (la casilla)
    // e.currentTarget ‚Üí El elemento que TIENE el listener (el tablero)
    
    // Ejemplo:
    // Si haces click en casilla #4:
    //   e.target ‚Üí <div class="casilla" data-index="4">
    //   e.currentTarget ‚Üí <div class="tablero" id="tablero">
    
    // ‚úÖ classList.contains('clase')
    // Verifica si un elemento tiene una clase espec√≠fica
    // Devuelve true o false
    
    // ========== COMPARACI√ìN COMPLETA ==========
    
    // ‚ùå SIN EVENT DELEGATION (9 listeners):
    // const c0 = document.querySelector('[data-index="0"]');
    // const c1 = document.querySelector('[data-index="1"]');
    // const c2 = document.querySelector('[data-index="2"]');
    // const c3 = document.querySelector('[data-index="3"]');
    // const c4 = document.querySelector('[data-index="4"]');
    // const c5 = document.querySelector('[data-index="5"]');
    // const c6 = document.querySelector('[data-index="6"]');
    // const c7 = document.querySelector('[data-index="7"]');
    // const c8 = document.querySelector('[data-index="8"]');
    // 
    // c0.addEventListener('click', () => jugar(c0));
    // c1.addEventListener('click', () => jugar(c1));
    // c2.addEventListener('click', () => jugar(c2));
    // c3.addEventListener('click', () => jugar(c3));
    // c4.addEventListener('click', () => jugar(c4));
    // c5.addEventListener('click', () => jugar(c5));
    // c6.addEventListener('click', () => jugar(c6));
    // c7.addEventListener('click', () => jugar(c7));
    // c8.addEventListener('click', () => jugar(c8));
    // 
    // Total: 9 event listeners en memoria
    
    // ‚úÖ CON EVENT DELEGATION (1 listener):
    // const tablero = document.querySelector('#tablero');
    // tablero.addEventListener('click', (e) => {
    //   if (e.target.classList.contains('casilla')) {
    //     jugar(e.target);
    //   }
    // });
    // 
    // Total: 1 solo event listener en memoria
    
    // ========== VENTAJAS ==========
    // 1. ‚ö° M√°s eficiente: Menos memoria (1 listener vs 9)
    // 2. üîß M√°s f√°cil de mantener: C√≥digo centralizado
    // 3. üìà Escalable: Funciona igual con 9 o 900 casillas
    // 4. üéØ Din√°mico: Funciona con elementos a√±adidos despu√©s
    //    (si a√±ades casillas con JavaScript, ¬°ya tienen listener!)
    
    // ========== CASOS DE USO REALES ==========
    
    // 1) Listas din√°micas:
    // const lista = document.querySelector('#lista');
    // lista.addEventListener('click', (e) => {
    //   if (e.target.tagName === 'LI') {
    //     e.target.remove();
    //   }
    // });
    // Funciona con items que a√±adas despu√©s
    
    // 2) Tablas grandes:
    // const tabla = document.querySelector('table');
    // tabla.addEventListener('click', (e) => {
    //   if (e.target.tagName === 'TD') {
    //     console.log('Celda:', e.target.textContent);
    //   }
    // });
    // Una tabla con 1000 celdas = 1 solo listener
    
    // 3) Men√∫s complejos:
    // const menu = document.querySelector('#menu');
    // menu.addEventListener('click', (e) => {
    //   if (e.target.matches('.menu-item')) {
    //     // Manejar item
    //   }
    // });
  </script>

</body>
</html>