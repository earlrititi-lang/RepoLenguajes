<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <title>Tres en Raya Completo</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
    }
    
    h1 {
      color: white;
      margin-bottom: 20px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }
    
    .info {
      background: white;
      padding: 15px 30px;
      border-radius: 8px;
      margin-bottom: 20px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      min-width: 250px;
      text-align: center;
    }
    
    .tablero {
      display: grid;
      grid-template-columns: repeat(3, 120px);
      grid-template-rows: repeat(3, 120px);
      gap: 8px;
      background-color: #2c3e50;
      padding: 8px;
      border-radius: 12px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
    }
    
    .casilla {
      background-color: white;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 64px;
      font-weight: bold;
      cursor: pointer;
      user-select: none;
      transition: all 0.3s;
      border-radius: 4px;
    }
    
    .casilla:hover:not(.ocupada) {
      background-color: #ecf0f1;
      transform: scale(1.05);
    }
    
    .casilla.ocupada {
      cursor: not-allowed;
    }
    
    .x {
      color: #e74c3c;
      animation: aparece 0.3s ease-out;
    }
    
    .o {
      color: #3498db;
      animation: aparece 0.3s ease-out;
    }
    
    @keyframes aparece {
      from {
        transform: scale(0);
        opacity: 0;
      }
      to {
        transform: scale(1);
        opacity: 1;
      }
    }
    
    .ganadora {
      background-color: #2ecc71 !important;
      animation: victoria 0.6s ease-in-out;
    }
    
    @keyframes victoria {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }
    
    .controles {
      margin-top: 20px;
      display: flex;
      gap: 10px;
    }
    
    button {
      padding: 12px 24px;
      font-size: 16px;
      background: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      transition: all 0.3s;
      font-weight: 600;
    }
    
    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(0,0,0,0.15);
    }
    
    button:active {
      transform: translateY(0);
    }
    
    .mensaje {
      background: white;
      padding: 20px 40px;
      border-radius: 8px;
      margin-top: 20px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      font-size: 20px;
      font-weight: bold;
      display: none;
    }
    
    .mensaje.visible {
      display: block;
      animation: aparece 0.5s ease-out;
    }
    
    .mensaje.victoria {
      color: #27ae60;
    }
    
    .mensaje.empate {
      color: #f39c12;
    }
  </style>
</head>
<body>

  <h1>ðŸŽ® Tres en Raya</h1>
  
  <div class="info">
    Turno: <strong id="turnoActual">X</strong>
  </div>

  <div class="tablero" id="tablero">
    <div class="casilla" data-index="0"></div>
    <div class="casilla" data-index="1"></div>
    <div class="casilla" data-index="2"></div>
    <div class="casilla" data-index="3"></div>
    <div class="casilla" data-index="4"></div>
    <div class="casilla" data-index="5"></div>
    <div class="casilla" data-index="6"></div>
    <div class="casilla" data-index="7"></div>
    <div class="casilla" data-index="8"></div>
  </div>

  <div class="controles">
    <button id="btnReiniciar">ðŸ”„ Reiniciar</button>
  </div>

  <div id="mensaje" class="mensaje"></div>

  <script>
    // ========== SOLUCIÃ“N EJERCICIO 7 - TRES EN RAYA COMPLETO ==========
    
    // ========== CONFIGURACIÃ“N ==========
    // Array bidimensional con todas las combinaciones ganadoras posibles
    // Cada sub-array contiene los Ã­ndices de las casillas que forman una lÃ­nea
    const COMBINACIONES_GANADORAS = [
      [0, 1, 2], // Fila superior (horizontal)
      [3, 4, 5], // Fila media (horizontal)
      [6, 7, 8], // Fila inferior (horizontal)
      [0, 3, 6], // Columna izquierda (vertical)
      [1, 4, 7], // Columna media (vertical)
      [2, 5, 8], // Columna derecha (vertical)
      [0, 4, 8], // Diagonal \ (de arriba-izq a abajo-der)
      [2, 4, 6]  // Diagonal / (de arriba-der a abajo-izq)
    ];
    // Visual del tablero con Ã­ndices:
    // [0] [1] [2]
    // [3] [4] [5]
    // [6] [7] [8]
    
    // ========== ESTADO DEL JUEGO ==========
    let turno = "X"; // Jugador actual
    let juegoActivo = true; // Â¿Se puede seguir jugando?
    
    // Seleccionar TODAS las casillas (devuelve NodeList similar a array)
    const casillas = document.querySelectorAll('.casilla');
    const tablero = document.querySelector('#tablero');
    const turnoActual = document.querySelector('#turnoActual');
    const btnReiniciar = document.querySelector('#btnReiniciar');
    const mensaje = document.querySelector('#mensaje');
    
    // ========== FUNCIONES DE VERIFICACIÃ“N ==========
    
    /**
     * Verifica si hay un ganador
     * @returns {Object|null} - Objeto con ganador y combinaciÃ³n, o null si no hay ganador
     */
    function verificarVictoria() {
      // Iterar sobre cada combinaciÃ³n ganadora
      for (const combinacion of COMBINACIONES_GANADORAS) {
        // Destructuring: extraer los 3 Ã­ndices de la combinaciÃ³n
        const [a, b, c] = combinacion;
        
        // Obtener el contenido de cada casilla
        const casilla1 = casillas[a].textContent;
        const casilla2 = casillas[b].textContent;
        const casilla3 = casillas[c].textContent;
        
        // Verificar si las 3 casillas:
        // 1. Tienen contenido (no estÃ¡n vacÃ­as)
        // 2. Todas tienen el mismo sÃ­mbolo
        if (casilla1 && casilla1 === casilla2 && casilla1 === casilla3) {
          console.log(`ðŸŽ‰ Victoria detectada: ${casilla1} en combinaciÃ³n [${combinacion}]`);
          
          // Retornar objeto con informaciÃ³n de la victoria
          return {
            ganador: casilla1,        // "X" o "O"
            combinacion: combinacion  // [0,1,2] o [0,4,8], etc.
          };
        }
      }
      
      // Si ninguna combinaciÃ³n ganÃ³, retornar null
      return null;
    }
    
    /**
     * Verifica si hay empate (tablero lleno sin ganador)
     * @returns {boolean} - true si todas las casillas estÃ¡n ocupadas
     */
    function verificarEmpate() {
      // Array.from() convierte NodeList a Array real
      // every() verifica que TODAS las casillas cumplan la condiciÃ³n
      return Array.from(casillas).every(casilla => casilla.textContent !== "");
    }
    
    // ========== FUNCIONES DE FINALIZACIÃ“N ==========
    
    /**
     * Muestra el ganador y resalta las casillas ganadoras
     * @param {string} ganador - "X" o "O"
     * @param {Array} combinacion - Array con Ã­ndices de casillas ganadoras
     */
    function mostrarGanador(ganador, combinacion) {
      // Desactivar juego
      juegoActivo = false;
      
      // Resaltar visualmente las casillas ganadoras
      combinacion.forEach(index => {
        casillas[index].classList.add('ganadora');
      });
      
      // Mostrar mensaje de victoria
      mensaje.textContent = `ðŸŽ‰ Â¡${ganador} ha ganado!`;
      mensaje.classList.add('visible', 'victoria');
      
      console.log(`ðŸ† Ganador: ${ganador}`);
    }
    
    /**
     * Muestra mensaje de empate
     */
    function mostrarEmpate() {
      // Desactivar juego
      juegoActivo = false;
      
      // Mostrar mensaje de empate
      mensaje.textContent = "ðŸ˜ Â¡Empate!";
      mensaje.classList.add('visible', 'empate');
      
      console.log("ðŸ¤ Empate - Tablero lleno");
    }
    
    // ========== FUNCIÃ“N PRINCIPAL DE JUEGO ==========
    
    /**
     * Ejecuta una jugada en una casilla
     * @param {HTMLElement} casilla - El elemento de la casilla clickeada
     */
    function jugar(casilla) {
      // ========== GUARD CLAUSES (Validaciones) ==========
      
      // Guard 1: Verificar si el juego estÃ¡ activo
      if (!juegoActivo) {
        console.log("âš ï¸ El juego ha terminado");
        return;
      }
      
      // Guard 2: Verificar si la casilla estÃ¡ vacÃ­a
      if (casilla.textContent !== "") {
        console.log("âš ï¸ Casilla ocupada");
        return;
      }
      
      // ========== REALIZAR JUGADA ==========
      
      // Escribir el sÃ­mbolo del turno actual
      casilla.textContent = turno;
      casilla.classList.add('ocupada', turno.toLowerCase());
      
      console.log(`âœ… ${turno} juega en casilla ${casilla.dataset.index}`);
      
      // ========== VERIFICAR RESULTADO ==========
      
      // Verificar victoria INMEDIATAMENTE despuÃ©s de jugar
      const resultado = verificarVictoria();
      if (resultado) {
        // Hay un ganador
        mostrarGanador(resultado.ganador, resultado.combinacion);
        return; // Terminar funciÃ³n
      }
      
      // Verificar empate (solo si no hay ganador)
      if (verificarEmpate()) {
        // Tablero lleno sin ganador
        mostrarEmpate();
        return; // Terminar funciÃ³n
      }
      
      // ========== CAMBIAR TURNO ==========
      // Si llegamos aquÃ­, el juego continÃºa
      turno = turno === "X" ? "O" : "X";
      turnoActual.textContent = turno;
      
      console.log(`âž¡ï¸ Turno de ${turno}`);
    }
    
    // ========== FUNCIÃ“N DE REINICIO ==========
    
    /**
     * Reinicia el juego al estado inicial
     */
    function reiniciar() {
      console.log("ðŸ”„ Reiniciando juego...");
      
      // Limpiar todas las casillas
      casillas.forEach(casilla => {
        casilla.textContent = "";
        casilla.classList.remove('ocupada', 'x', 'o', 'ganadora');
      });
      
      // Reiniciar estado
      turno = "X";
      juegoActivo = true;
      turnoActual.textContent = turno;
      
      // Ocultar mensaje
      mensaje.classList.remove('visible', 'victoria', 'empate');
      
      console.log("âœ¨ Juego reiniciado");
    }
    
    // ========== EVENT LISTENERS ==========
    
    // Event delegation: un solo listener en el tablero
    tablero.addEventListener('click', (e) => {
      // Verificar que el click fue en una casilla
      if (e.target.classList.contains('casilla')) {
        jugar(e.target);
      }
    });
    
    // Listener del botÃ³n reiniciar
    btnReiniciar.addEventListener('click', reiniciar);
    
    // ========== CONCEPTOS CLAVE DEL EJERCICIO 7 ==========
    
    // âœ… ARRAYS DE COMBINACIONES
    // Definimos todas las formas posibles de ganar
    // Es mÃ¡s eficiente que verificar todo el tablero cada vez
    
    // âœ… ALGORITMO DE VERIFICACIÃ“N
    // for...of itera sobre cada combinaciÃ³n
    // Destructuring [a,b,c] extrae los Ã­ndices
    // Comparamos si las 3 casillas tienen el mismo valor
    
    // âœ… EVERY() - MÃ©todo de arrays
    // Verifica que TODOS los elementos cumplan una condiciÃ³n
    // Retorna true solo si TODOS son true
    // Ejemplo:
    // [1, 2, 3].every(n => n > 0) â†’ true
    // [1, 2, 0].every(n => n > 0) â†’ false
    
    // âœ… GESTIÃ“N DE ESTADOS
    // juegoActivo = bandera (flag) que controla si se puede jugar
    // Previene jugadas despuÃ©s de terminar el juego
    
    // âœ… EARLY RETURNS
    // Usar return para salir de la funciÃ³n cuando detectamos victoria/empate
    // Evita ejecutar cÃ³digo innecesario
    
    // âœ… SEPARACIÃ“N DE RESPONSABILIDADES
    // Cada funciÃ³n tiene UNA responsabilidad:
    //   â€¢ verificarVictoria() â†’ Solo verifica
    //   â€¢ mostrarGanador() â†’ Solo muestra resultado
    //   â€¢ jugar() â†’ Coordina todo
    
    // ========== FLUJO COMPLETO DE UNA JUGADA ==========
    
    // 1. Usuario hace click
    // 2. Event delegation captura el click
    // 3. Verifica que sea una casilla
    // 4. Llama a jugar(casilla)
    //    4.1. Guard: Â¿juego activo? â†’ Si no, return
    //    4.2. Guard: Â¿casilla vacÃ­a? â†’ Si no, return
    //    4.3. Escribir sÃ­mbolo
    //    4.4. Verificar victoria
    //        4.4.1. Si hay victoria â†’ mostrarGanador() â†’ return
    //    4.5. Verificar empate
    //        4.5.1. Si hay empate â†’ mostrarEmpate() â†’ return
    //    4.6. Cambiar turno
    // 5. Esperar siguiente click
    
    // ========== OPTIMIZACIONES POSIBLES ==========
    
    // 1. En lugar de verificar TODAS las combinaciones,
    //    podrÃ­as verificar solo las que incluyen la Ãºltima casilla jugada
    
    // 2. PodrÃ­as llevar un contador de jugadas:
    //    let jugadas = 0;
    //    jugadas++;
    //    if (jugadas === 9 && !hayGanador) â†’ empate
    //    (MÃ¡s eficiente que verificar todas las casillas)
    
    // 3. PodrÃ­as almacenar el estado en un array:
    //    let estado = ["", "", "", "", "", "", "", "", ""];
    //    (Facilita verificaciones y permite deshacer jugadas)
  </script>

</body>
</html>